<!doctype html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D"> 
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0"> 
  <meta name="referrer" content="unsafe-url"> 
  <title>Мир приключений по API-серверу Kubernetes. Часть 2. Наблюдение и кэширование / Комментарии / Хабр</title> 
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style> 
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.b6238726.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.04dfe291.js" as="script">
  <link rel="preload" href="https://assets.habr.com/habr-web/css/app.9b76199c.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/app.de623c19.js" as="script">
  <link rel="preload" href="https://assets.habr.com/habr-web/css/page-article-comments.cc6a301a.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/page-article-comments.69757054.js" as="script">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" as="script"> 
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.b6238726.css">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.9b76199c.css">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/page-article-comments.cc6a301a.css"> 
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.20fb7121c5d9f14909af6c8354ebb9b2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script> 
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script> 
  <style>.grecaptcha-badge{visibility: hidden;}</style> 
  <meta name="habr-version" content="2.119.0"> 
  <meta data-vue-meta="ssr" itemprop="image" content="/img/habr_ru.png" data-vmid="image:itemprop">
  <meta data-vue-meta="ssr" property="og:image" content="/img/habr_ru.png" data-vmid="og:image">
  <meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width">
  <meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <meta data-vue-meta="ssr" property="aiturec:image" content="/img/habr_ru.png" data-vmid="aiturec:image">
  <meta data-vue-meta="ssr" name="twitter:image" content="/img/habr_ru.png" data-vmid="twitter:image">
  <meta data-vue-meta="ssr" property="vk:image" content="/img/habr_ru.png?format=vk" data-vmid="vk:image">
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613">
  <meta data-vue-meta="ssr" property="fb:pages" content="472597926099084">
  <meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image">
  <meta data-vue-meta="ssr" name="twitter:site" content="@habr_com">
  <meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale">
  <meta data-vue-meta="ssr" property="og:type" content="website" data-vmid="og:type">
  <meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name">
  <meta data-vue-meta="ssr" property="og:title" content="Хабр" data-vmid="og:title">
  <meta data-vue-meta="ssr" property="og:url" content="https://habr.com/ru/companies/southbridge/articles/727510/comments/" data-vmid="og:url"> 
  <link data-vue-meta="ssr" rel="image_src" href="/img/habr_ru.png" data-vmid="image:href">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/727510/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss">
  <link data-vue-meta="ssr" href="https://habr.com/ru/companies/southbridge/articles/727510/" rel="canonical" data-vmid="canonical"> 
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44"> 
  <meta name="msapplication-TileColor" content="#629FBC"> 
  <meta name="apple-mobile-web-app-capable" content="yes"> 
  <meta name="mobile-web-app-capable" content="yes"> 
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"> 
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"> 
  <link rel="mask-icon" color="#77a2b6" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"> 
  <link crossorigin="use-credentials" href="/manifest.webmanifest" rel="manifest"> 
  <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script> 
  <script>window.yaContextCb = window.yaContextCb || []</script> 
  <script src="https://yandex.ru/ads/system/context.js" async></script> 
 </head> 
 <body> 
  <div id="app" data-server-rendered="true" data-async-called="true">
   <div class="tm-layout__wrapper">
    <!----> 
    <div></div> <!----> 
    <header class="tm-header">
     <div class="tm-page-width">
      <div class="tm-header__container">
       <!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru">
         <svg height="16" width="16" class="tm-svg-img tm-header__icon">
          <title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use>
         </svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> 
       <div class="tm-dropdown tm-header__projects">
        <div class="tm-dropdown__head">
         <button class="tm-header__dropdown-toggle">
          <svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown">
           <title>Открыть список</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#arrow-down"></use>
          </svg></button>
        </div> <!---->
       </div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn"> Как стать автором </a> 
       <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline">
        <!---->
       </div> <!----> <!---->
      </div>
     </div>
    </header> 
    <div class="tm-layout">
     <div class="tm-page-progress-bar"></div> 
     <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky">
      <div class="tm-page-width">
       <div class="tm-base-layout__header-wrapper">
        <div class="tm-main-menu">
         <div class="tm-main-menu__section">
          <nav class="tm-main-menu__section-content">
           <!----> <a href="/ru/all/" class="tm-main-menu__item"> Все потоки </a> <a href="/ru/flows/develop/" class="tm-main-menu__item"> Разработка </a><a href="/ru/flows/admin/" class="tm-main-menu__item"> Администрирование </a><a href="/ru/flows/design/" class="tm-main-menu__item"> Дизайн </a><a href="/ru/flows/management/" class="tm-main-menu__item"> Менеджмент </a><a href="/ru/flows/marketing/" class="tm-main-menu__item"> Маркетинг </a><a href="/ru/flows/popsci/" class="tm-main-menu__item"> Научпоп </a>
          </nav>
         </div>
        </div> 
        <div class="tm-header-user-menu tm-base-layout__user-menu">
         <a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search">
          <svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark">
           <title>Поиск</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#search"></use>
          </svg></a> <!----> <!----> <!----> 
         <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop">
          <div class="tm-dropdown">
           <div class="tm-dropdown__head">
            <svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark">
             <title>Профиль</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#header-user"></use>
            </svg> <!---->
           </div> <!---->
          </div> <!---->
         </div> <!---->
        </div>
       </div>
      </div>
     </div> <!----> 
     <div class="tm-page-width"></div> 
     <main class="tm-layout__container">
      <div hl="ru" companyname="southbridge" data-async-called="true" class="tm-page">
       <div class="tm-page-width">
        <!----> 
        <div class="tm-page__wrapper">
         <div class="tm-page__main tm-page__main_has-sidebar">
          <div class="pull-down">
           <!----> 
           <div class="pull-down__header" style="height:0px;">
            <div class="pull-down__content" style="bottom:10px;">
             <svg height="24" width="24" class="tm-svg-img pull-down__arrow">
              <title>Обновить</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#pull-arrow"></use>
             </svg>
            </div>
           </div> 
           <article class="tm-article-comments__article-body">
            <div class="tm-article-comments__article-snippet">
             <div class="tm-article-snippet tm-article-snippet">
              <div class="tm-article-snippet__meta-container">
               <div class="tm-article-snippet__meta">
                <span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/Anna_sokol22/" title="Anna_sokol22" class="tm-user-info__userpic">
                  <div class="tm-entity-image">
                   <img alt="" height="24" src="//habrastorage.org/r/w48/getpro/habr/avatars/8a0/768/a4b/8a0768a4b3e1a9fdcddae1bb0d0b5ee2.jpg" width="24" class="tm-entity-image__pic">
                  </div></a> <span class="tm-user-info__user"><a href="/ru/users/Anna_sokol22/" class="tm-user-info__username"> Anna_sokol22 <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-04-07T13:02:21.000Z" title="2023-04-07, 16:02">9 часов назад</time></span></span></span>
               </div> <!---->
              </div> 
              <h1 class="tm-title tm-title_h1"><a href="/ru/companies/southbridge/articles/727510/" data-test-id="article-snippet-title-link" data-article-link="true" class="tm-title__link router-link-active"><span>Мир приключений по API-серверу Kubernetes. Часть 2. Наблюдение и кэширование</span></a></h1> 
              <div class="tm-article-snippet__stats">
               <!----> 
               <div class="tm-article-reading-time">
                <span class="tm-svg-icon__wrapper tm-article-reading-time__icon">
                 <svg height="24" width="24" class="tm-svg-img tm-svg-icon">
                  <title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#clock"></use>
                 </svg></span> <span class="tm-article-reading-time__label"> 19 мин </span>
               </div> <span class="tm-icon-counter tm-data-icons__item">
                <svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon">
                 <title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-views"></use>
                </svg> <span class="tm-icon-counter__value">381</span></span>
              </div> 
              <div class="tm-article-snippet__hubs-container">
               <div class="tm-article-snippet__hubs">
                <span class="tm-article-snippet__hubs-item"><a href="/ru/companies/southbridge/articles/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании Southbridge</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/it-infrastructure/" class="tm-article-snippet__hubs-item-link"><span>IT-инфраструктура</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/devops/" class="tm-article-snippet__hubs-item-link"><span>DevOps</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/kubernetes/" class="tm-article-snippet__hubs-item-link"><span>Kubernetes</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span>
               </div>
              </div> 
              <div class="tm-article-snippet__labels-container">
               <div class="tm-article-snippet__labels">
                <!----> 
                <div class="tm-article-snippet__label tm-article-snippet__label tm-article-snippet__label_variant-translation">
                 <span> Перевод </span>
                </div>
               </div>
              </div> <!----> <!---->
             </div> 
             <div class="tm-data-icons">
              <!----> 
              <div class="tm-votes-meter tm-data-icons__item">
               <svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article">
                <title>Всего голосов 6: ↑6 и ↓0</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-rating"></use>
               </svg> <span title="Всего голосов 6: ↑6 и ↓0" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+6</span>
              </div> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon">
                <svg height="24" width="24" class="tm-svg-img tm-svg-icon">
                 <title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-favorite"></use>
                </svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter"> 13 </span></button> 
              <div title="Поделиться" class="tm-sharing tm-data-icons__item">
               <button type="button" class="tm-sharing__button">
                <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon">
                 <path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path>
                </svg></button> 
               <div class="v-portal" style="display:none;"></div>
              </div> 
              <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item">
               <a href="/ru/companies/southbridge/articles/727510/comments/" aria-current="page" class="tm-article-comments-counter-link__link">
                <svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon">
                 <title>Комментарии</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#counter-comments"></use>
                </svg> <span class="tm-article-comments-counter-link__value"> 0 </span></a> <!---->
              </div> <!----> 
              <div class="v-portal" style="display:none;"></div>
             </div>
            </div>
           </article> <!----> 
           <div data-async-called="true" class="tm-article-comments-offloaded">
            <div class="tm-article-comments">
             <div class="tm-comments-wrapper">
              <div class="tm-comments-wrapper__wrapper">
               <header class="tm-comments-wrapper__header">
                <h2 class="tm-comments-wrapper__title"> Комментарии <!----></h2> 
                <div class="tm-comments-wrapper__header-aside">
                 <!----> <button class="tm-rss-button tm-rss-button_comments-header"><span class="tm-svg-icon__wrapper tm-rss-button__icon">
                   <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
                    <title>Скопировать ссылку на RSS</title> <use xlink:href="/img/megazord-v28.c350aa68..svg#rss"></use>
                   </svg></span></button> <!---->
                </div>
               </header> 
               <div class="tm-comments-wrapper__inner"> <!----> 
                <div class="tm-comments__empty">
                 <span>Здесь пока нет ни одного комментария, вы&nbsp;можете&nbsp;стать первым!</span>
                </div> 
                <div class="v-portal" style="display:none;"></div>
               </div>
              </div> 
              <div class="tm-notice tm-comments__comment-notice tm-notice_positive">
               <!----> 
               <div class="tm-notice__inner">
                <!----> 
                <div class="tm-notice__content">
                 <span>Только полноправные пользователи могут оставлять комментарии. <a rel="nofollow" href="/kek/v1/auth/habrahabr/?back=/ru/companies/southbridge/articles/727510/comments/&amp;hl=ru">Войдите</a>, пожалуйста.</span>
                </div>
               </div>
              </div>
             </div>
            </div>
           </div> <!----> <!---->
          </div>
         </div> 
         <div class="tm-page__sidebar">
          <div hl="ru" class="tm-layout-sidebar">
           <div class="tm-layout-sidebar__placeholder_initial"></div> 
           <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;">
            <!----> <!----> <!---->
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </main> <!---->
    </div> 
    <div class="tm-footer-menu">
     <div class="tm-page-width">
      <div class="tm-footer-menu__container">
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Ваш аккаунт </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/companies/southbridge/articles/727510/comments/&amp;hl=ru" rel="nofollow" target="_self"> Войти </a></li>
          <li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/companies/southbridge/articles/727510/comments/&amp;hl=ru" rel="nofollow" target="_self"> Регистрация </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Разделы </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active"> Статьи </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link"> Новости </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link"> Хабы </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link router-link-active"> Компании </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link"> Авторы </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link"> Песочница </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Информация </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link"> Устройство сайта </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link"> Для авторов </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link"> Для компаний </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link"> Документы </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank"> Соглашение </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank"> Конфиденциальность </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Услуги </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank"> Корпоративный блог </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank"> Медийная реклама </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank"> Нативные проекты </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank"> Образовательные программы </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank"> Стартапам </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/specials/" class="footer-menu__item-link"> Спецпроекты </a></li>
         </ul>
        </div>
       </div>
      </div>
     </div>
    </div> 
    <div class="tm-footer">
     <div class="tm-page-width">
      <div class="tm-footer__container">
       <!----> 
       <div class="tm-footer__social">
        <a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use>
         </svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use>
         </svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use>
         </svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use>
         </svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use>
         </svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use>
         </svg></a>
       </div> 
       <div class="v-portal" style="display:none;"></div> <button class="tm-footer__link"><!----> Настройка языка </button> <a href="/ru/feedback/" class="tm-footer__link"> Техническая поддержка </a> <a href="/berserk-mode-nope" class="tm-footer__link"> Вернуться на старую версию </a> 
       <div class="tm-footer-copyright">
        <span class="tm-copyright"><span class="tm-copyright__years">© 2006–2023, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span>
       </div>
      </div>
     </div>
    </div> <!----> <!---->
   </div> 
   <div class="vue-portal-target"></div>
  </div> 
  <script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"727510":{"id":"727510","timePublished":"2023-04-07T13:02:21+00:00","isCorporative":true,"lang":"ru","titleHtml":"Мир приключений по API-серверу Kubernetes. Часть 2. Наблюдение и кэширование","leadData":{"textHtml":"\u003Cp\u003EВ нашей предыдущей статье про приключения сервера Kubernetes API мы рассмотрели интерфейс хранилища и исследовали единственную реализацию в дереве: etcd3. Однако внимательное прочтение сносок в этом посте показало, что мы были не совсем честными, говоря, что etcd3 — единственная реализация.\u003C\u002Fp\u003E\u003Cp\u003EЭто можно оспорить, ведь Cacher также может быть технической реализацией, хотя ему и требуется базовая реализация. Подробно рассмотрим кэширование в одном из будущих постов. А сейчас подробно изучим кэширование и его возможности.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F446\u002F913\u002Fa17\u002F446913a171b09a149098ae918196b04b.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F446\u002F913\u002Fa17\u002F446913a171b09a149098ae918196b04b.png","fit":"cover","positionY":0,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"DANIEL MANGUM","originalUrl":"https:\u002F\u002Fdanielmangum.com\u002Fposts\u002Fk8s-asa-watching-and-caching\u002F"}}],"author":{"id":"2870007","alias":"Anna_sokol22","fullname":"Аня Сокол","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8a0\u002F768\u002Fa4b\u002F8a0768a4b3e1a9fdcddae1bb0d0b5ee2.jpg","speciality":null,"scoreStats":{"score":13,"votesCount":105},"rating":37.8,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null}},"statistics":{"commentsCount":0,"favoritesCount":13,"readingCount":381,"score":6,"votesCount":6,"votesCountPlus":6,"votesCountMinus":0},"hubs":[{"id":"17901","alias":"southbridge","type":"corporative","title":"Блог компании Southbridge","titleHtml":"Блог компании Southbridge","isProfiled":false,"relatedData":null},{"id":"6398","alias":"it-infrastructure","type":"collective","title":"IT-инфраструктура","titleHtml":"IT-инфраструктура","isProfiled":true,"relatedData":null},{"id":"20788","alias":"devops","type":"collective","title":"DevOps","titleHtml":"DevOps","isProfiled":true,"relatedData":null},{"id":"22196","alias":"kubernetes","type":"collective","title":"Kubernetes","titleHtml":"Kubernetes","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F446\u002F913\u002Fa17\u002F446913a171b09a149098ae918196b04b.png\" width=\"1080\" height=\"609\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F446\u002F913\u002Fa17\u002F446913a171b09a149098ae918196b04b.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EВ нашей предыдущей статье про приключения сервера Kubernetes API мы рассмотрели интерфейс хранилища и исследовали единственную реализацию в дереве: etcd3. Однако внимательное прочтение сносок в этом посте показало, что мы были не совсем честными, говоря, что etcd3 — единственная реализация.\u003C\u002Fp\u003E\u003Cp\u003EЭто можно оспорить, ведь Cacher также может быть технической реализацией, хотя ему и требуется базовая реализация. Подробно рассмотрим кэширование в одном из будущих постов. А сейчас подробно изучим кэширование и его возможности. \u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F934\u002F15e\u002F43f\u002F93415e43f565a17db6ed85ce047607db.png\" width=\"1920\" height=\"1080\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F934\u002F15e\u002F43f\u002F93415e43f565a17db6ed85ce047607db.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003E\u003Cstrong\u003EО чём поговорим в статье:\u003C\u002Fstrong\u003E \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EНаблюдение (👈 «Я хочу проблему и ее решение»);\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EВсе смотрят;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EКэширование (👈 «Мне просто нужно решение»);\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EwatchCache \u003C\u002Fcode\u003E;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EcacherListerWatcher \u003C\u002Fcode\u003E;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EReflector\u003C\u002Fcode\u003E;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EСвяжем всё вместе; \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EМетод \u003Ccode\u003E Watch()\u003C\u002Fcode\u003E;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EВсе смотрят… Успешно (👈 «Просто покажите мне код»).\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch2\u003EНаблюдение\u003C\u002Fh2\u003E\u003Cp\u003EПрежде чем мы введем какой-либо тип кэширования, стоит вернуться к тому факту, что \u003Ccode\u003Estorage.Interface\u003C\u002Fcode\u003E включает в себя метод \u003Ccode\u003EWatch\u003C\u002Fcode\u003E, реализация \u003Ccode\u003Eetcd3\u003C\u002Fcode\u003E \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fkubernetes\u002Fkubernetes\u002Fblob\u002F3154010eec3488dd64110e3ca6c4ba0b5ac61310\u002Fstaging\u002Fsrc\u002Fk8s.io\u002Fapiserver\u002Fpkg\u002Fstoraghttps:\u002F\u002Fgithub.com\u002Fkubernetes\u002Fkubernetes\u002Fblob\u002F3154010eec3488dd64110e3ca6c4ba0b5ac61310\u002Fstaging\u002Fsrc\u002Fk8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fetcd3\u002Fstore.go#L847e\u002Fetcd3\u002Fstore.go#L847\"\u003E\u003Cu\u003Eподдерживает его\u003C\u002Fu\u003E\u003C\u002Fa\u003E. Ранее \u003Ca href=\"https:\u002F\u002Fdanielmangum.com\u002Fposts\u002Fk8s-asa-the-storage-interface\u002F#our-good-friend-etcd\"\u003E\u003Cu\u003Eмы изучали\u003C\u002Fu\u003E\u003C\u002Fa\u003E возможность отслеживания изменений, обращаясь непосредственно к \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E с помощью \u003Ccode\u003Eetcdctl\u003C\u002Fcode\u003E. \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E предлагает \u003Ca href=\"https:\u002F\u002Fetcd.io\u002Fdocs\u002Fv3.5\u002Flearning\u002Fapi\u002F#watch-api\"\u003E\u003Cu\u003EWatch API\u003C\u002Fu\u003E\u003C\u002Fa\u003E, который использует двунаправленные потоки gRPC для доставки событий клиентам при изменении значения для \u003Ca href=\"https:\u002F\u002Fgrpc.io\u002Fdocs\u002Fwhat-is-grpc\u002Fcore-concepts\u002F#bidirectional-streaming-rpc\"\u003E\u003Cu\u003Eключа\u003C\u002Fu\u003E\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EРеализация etcd3 Watch \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fkubernetes\u002Fkubernetes\u002Fblob\u002F3154010eec3488dd64110e3ca6c4ba0b5ac61310\u002Fstaging\u002Fsrc\u002Fk8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fetcd3\u002Fstore.go#L856\"\u003E\u003Cu\u003Eсоздает \u003C\u002Fu\u003E\u003C\u002Fa\u003E\u003Ccode\u003Ewatch.Interface\u003C\u002Fcode\u003E, поддерживаемый \u003Ccode\u003Ewatcher\u003C\u002Fcode\u003E. Новый \u003Ccode\u003Ewatcher\u003C\u002Fcode\u003E создается при каждом вызове \u003Ccode\u003EWatch\u003C\u002Fcode\u003E, и каждый \u003Ccode\u003Ewatcher\u003C\u002Fcode\u003E, по сути, просто вызывает \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E Watch API и пересылает события по каналу.\u003C\u002Fp\u003E\u003Cp\u003EДавайте возьмем нашу программу из \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fsouthbridge\u002Farticles\u002F727470\u002F\"\u003E\u003Cu\u003Eпредыдущего поста\u003C\u002Fu\u003E\u003C\u002Fa\u003E и модифицируем её, чтобы отслеживать изменения во всех \u003Ccode\u003EConfigMaps\u003C\u002Fcode\u003E в кластере.\u003C\u002Fp\u003E\u003Cp\u003EВы можете найти инструкции о том, как получить данные PCI, необходимые для связи с \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E в кластере \u003Ccode\u003Ekind\u003C\u002Fcode\u003E, \u003Ca href=\"https:\u002F\u002Fdanielmangum.com\u002Fposts\u002Fk8s-asa-the-storage-interface\u002F#calling-the-storageinterface-directly\"\u003E\u003Cu\u003Eздесь\u003C\u002Fu\u003E\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Edirectwatch.go\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Epackage main\n\nimport (\n\t\"context\"\n\t\"fmt\"\n\n\t\"go.etcd.io\u002Fetcd\u002Fclient\u002Fpkg\u002Fv3\u002Ftransport\"\n\tclientv3 \"go.etcd.io\u002Fetcd\u002Fclient\u002Fv3\"\n\tv1 \"k8s.io\u002Fapi\u002Fcore\u002Fv1\"\n\t\"k8s.io\u002Fapimachinery\u002Fpkg\u002Fruntime\"\n\t\"k8s.io\u002Fapimachinery\u002Fpkg\u002Fruntime\u002Fserializer\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fetcd3\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fvalue\u002Fencrypt\u002Fidentity\"\n\t\"k8s.io\u002Fkubernetes\u002Fpkg\u002Fapis\u002Fcore\"\n\tk8sv1 \"k8s.io\u002Fkubernetes\u002Fpkg\u002Fapis\u002Fcore\u002Fv1\"\n)\n\nfunc main() {\n\ttlsConfig, err := (transport.TLSInfo{\n\t\tCertFile:       \".\u002Fpki\u002Fetcd\u002Fserver.crt\",\n\t\tKeyFile:        \".\u002Fpki\u002Fetcd\u002Fserver.key\",\n\t\tTrustedCAFile:  \".\u002Fpki\u002Fetcd\u002Fca.crt\",\n\t\tClientCertFile: \".\u002Fpki\u002Fapiserver-etcd-client.crt\",\n\t\tClientKeyFile:  \".\u002Fpki\u002Fapiserver-etcd-client.key\",\n\t}).ClientConfig()\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tc, err := clientv3.New(clientv3.Config{\n\t\tEndpoints: []string{\"https:\u002F\u002F127.0.0.1:2379\"},\n\t\tTLS:       tlsConfig,\n\t})\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\tscheme := runtime.NewScheme()\n\tk8sv1.AddToScheme(scheme)\n\tcore.AddToScheme(scheme)\n\tf := serializer.NewCodecFactory(scheme)\n\ts := etcd3.New(c, f.CodecForVersions(nil, f.UniversalDecoder(), nil, k8sv1.SchemeGroupVersion), nil, \"registry\", v1.Resource(\"ConfigMap\"), identity.NewEncryptCheckTransformer(), true, etcd3.NewDefaultLeaseManagerConfig())\n\tw, err := s.Watch(context.Background(), \"configmaps\", storage.ListOptions{\n\t\tPredicate: storage.Everything,\n\t\tRecursive: true,\n\t})\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tfor e := range w.ResultChan() {\n\t\tco, ok := e.Object.(*v1.ConfigMap)\n\t\tif !ok {\n\t\t\tpanic(\"not a config map!\")\n\t\t}\n\t\tfmt.Printf(\"%s || %s\u002F%s\\n\", e.Type, co.Namespace, co.Name)\n\t}\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОбратите внимание на тот факт, что мы регистрируем типы из \u003Ccode\u003Ek8s.io\u002Fkubernetes\u003C\u002Fcode\u003E скорее, чем \u003Ccode\u003Ek8s.io\u002Fapi\u003C\u002Fcode\u003E. Это нужно, чтобы выполнить преобразование \u003Ccode\u003Einternal\u003C\u002Fcode\u003E версии в нашу желаемую версию (\u003Ccode\u003Ev1\u003C\u002Fcode\u003E). Мы также передаем \u003Ccode\u003Enil  CodecForVersions,\u003C\u002Fcode\u003E поскольку декодируем их только при чтении событий потока.\u003C\u002Fp\u003E\u003Cp\u003EЕсли у вас запущен кластер \u003Ccode\u003Ekind\u003C\u002Fcode\u003E, вы можете начать перенаправление портов \u003Ccode\u003Eetcd Pod\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ kubectl port-forward -n kube-system pod\u002Fetcd-kind-control-plane 2379:2379\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТеперь мы можем начать нашу программу.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ go run directwatch.go\nADDED || default\u002Fkube-root-ca.crt\nADDED || kube-node-lease\u002Fkube-root-ca.crt\nADDED || kube-public\u002Fcluster-info\nADDED || kube-public\u002Fkube-root-ca.crt\nADDED || kube-system\u002Fcoredns\nADDED || kube-system\u002Fextension-apiserver-authentication\nADDED || kube-system\u002Fkube-proxy\nADDED || kube-system\u002Fkube-root-ca.crt\nADDED || kube-system\u002Fkubeadm-config\nADDED || kube-system\u002Fkubelet-config\nADDED || local-path-storage\u002Fkube-root-ca.crt\nADDED || local-path-storage\u002Flocal-path-config\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКак и ожидалось, мы получаем \u003Ccode\u003EADDED\u003C\u002Fcode\u003E события для всех \u003Ccode\u003EConfigMaps\u003C\u002Fcode\u003E, находящихся в данный момент в кластере. Можно создавать, обновлять и удалять \u003Ccode\u003EConfigMap\u003C\u002Fcode\u003E, чтобы увидеть, как другие события отражаются в потоке просмотра.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ kubectl create configmap k8s-asa --from-literal hello=world\nconfigmap\u002Fk8s-asa created\n\n$ kubectl create configmap k8s-asa --from-literal hello=asa -o yaml --dry-run | kubectl apply -f -\nconfigmap\u002Fk8s-asa configured\n\n$ kubectl delete configmap k8s-asa\nconfigmap \"k8s-asa\" deleted\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПосмотрим на каждое из этих событий в потоке просмотра с соответствующим типом.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EADDED || default\u002Fk8s-asa\nMODIFIED || default\u002Fk8s-asa\nDELETED || default\u002Fk8s-asa\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2\u003EОбщее наблюдение\u003C\u002Fh2\u003E\u003Cp\u003EТеперь мы можем получать события в любое время, когда меняется интересующий нас тип, и не похоже, что \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E или наша маленькая программа сильно «потеют». Но давайте взглянем на некоторые показатели \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E, чтобы убедиться в этом. Мы можем найти открытый адрес метрик для \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E в нашем кластере \u003Ccode\u003Ekind\u003C\u002Fcode\u003E, просмотрев команду для контейнера в модуле \u003Ccode\u003EPod\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ kubectl get pod -n kube-system etcd-kind-control-plane -o=jsonpath={.spec.containers[0].command} | jq .\n\n[\n  \"etcd\",\n  \"--advertise-client-urls=https:\u002F\u002F172.19.0.2:2379\",\n  \"--cert-file=\u002Fetc\u002Fkubernetes\u002Fpki\u002Fetcd\u002Fserver.crt\",\n  \"--client-cert-auth=true\",\n  \"--data-dir=\u002Fvar\u002Flib\u002Fetcd\",\n  \"--experimental-initial-corrupt-check=true\",\n  \"--experimental-watch-progress-notify-interval=5s\",\n  \"--initial-advertise-peer-urls=https:\u002F\u002F172.19.0.2:2380\",\n  \"--initial-cluster=kind-control-plane=https:\u002F\u002F172.19.0.2:2380\",\n  \"--key-file=\u002Fetc\u002Fkubernetes\u002Fpki\u002Fetcd\u002Fserver.key\",\n  \"--listen-client-urls=https:\u002F\u002F127.0.0.1:2379,https:\u002F\u002F172.19.0.2:2379\",\n  \"--listen-metrics-urls=http:\u002F\u002F127.0.0.1:2381\",\n  \"--listen-peer-urls=https:\u002F\u002F172.19.0.2:2380\",\n  \"--name=kind-control-plane\",\n  \"--peer-cert-file=\u002Fetc\u002Fkubernetes\u002Fpki\u002Fetcd\u002Fpeer.crt\",\n  \"--peer-client-cert-auth=true\",\n  \"--peer-key-file=\u002Fetc\u002Fkubernetes\u002Fpki\u002Fetcd\u002Fpeer.key\",\n  \"--peer-trusted-ca-file=\u002Fetc\u002Fkubernetes\u002Fpki\u002Fetcd\u002Fca.crt\",\n  \"--snapshot-count=10000\",\n  \"--trusted-ca-file=\u002Fetc\u002Fkubernetes\u002Fpki\u002Fetcd\u002Fca.crt\"\n]\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Ccode\u003E--listen-metrics-urls\u003C\u002Fcode\u003E  — то, что мы ищем .\u003Ccode\u003Eetcd\u003C\u002Fcode\u003E будет обслуживать \u003Ca href=\"https:\u002F\u002Fdanielmangum.com\u002Fposts\u002Fk8s-asa-watching-and-caching\u002F\"\u003E\u003Cu\u003Eпоказатели \u003C\u002Fu\u003E\u003C\u002Fa\u003EPrometheus в конечной точке \u003Ccode\u003E\u002Fmetrics\u003C\u002Fcode\u003E по этому адресу. Создаём минимальный конфигурационный файл Prometheus, чтобы дать команду сборщику выполнить очистку \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Eprometheus.yml\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eglobal:\n  scrape_interval: 1s\nscrape_configs:\n  - job_name: etcd\n    static_configs:\n    - targets: ['127.0.0.1:2379']\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПрежде чем мы запустим Prometheus, убедитесь, что можно получить доступ к конечной точке \u003Ccode\u003Eetcd metrics\u003C\u002Fcode\u003E. Перенаправление портов в пространство имен \u003Ccode\u003Ehost network\u003C\u002Fcode\u003E позволит запускать Prometheus в пространстве имен \u003Ccode\u003Ehost network\u003C\u002Fcode\u003E, что упрощает доступ к панели мониторинга в браузере.\u003C\u002Fp\u003E\u003Cp\u003EПеренесите конечную точку \u003Ccode\u003Eetcd metrics\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ kubectl port-forward -n kube-system pod\u002Fetcd-kind-control-plane 2381:2381\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЗатем запустите контейнер Prometheus, подключённый к сети хоста.  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ docker run --net=host --rm -v $(pwd)\u002Fprometheus.yml:\u002Fetc\u002Fprometheus\u002Fprometheus.yml prom\u002Fprometheus\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПанель мониторинга Prometheus теперь должна быть доступна в браузере по адресу \u003Ccode\u003E127.0.0.1:9090\u003C\u002Fcode\u003E. Мы можем получить график показателей, которые предоставляет \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E, введя запрос. Например, \u003Ccode\u003Eirate(process_cpu_seconds_total{job=\"etcd\"}[5m])\u003C\u002Fcode\u003E покажет скорость увеличения общего системного и пользовательского процессорного времени. Если запустить программу сейчас, которая устанавливает просмотры для \u003Ccode\u003EConfigMaps\u003C\u002Fcode\u003E, мы не увидим существенного влияния на процессор.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3a1\u002Fe4c\u002Fb70\u002F3a1e4cb705e9372e9e24451daed74cf6.png\" width=\"3836\" height=\"2000\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3a1\u002Fe4c\u002Fb70\u002F3a1e4cb705e9372e9e24451daed74cf6.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EДиапазон по оси Y составляет от \u003Ccode\u003E0.03\u003C\u002Fcode\u003E\u003Cem\u003E до \u003C\u002Fem\u003E\u003Ccode\u003E0.23\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003E\u003Cstrong\u003EПримечание:\u003C\u002Fstrong\u003E Поскольку мы запускаем \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E в кластере \u003Ccode\u003Ekind\u003C\u002Fcode\u003E, сервер API Kubernetes и другие компоненты взаимодействуют с ним в дополнение к нагрузке от программы.\u003C\u002Fp\u003E\u003Cp\u003EЭтого и следовало ожидать: одни часы вряд ли окажут существенное влияние. Но если мы увеличим количество часов, то начнем сталкиваться с проблемами. Давайте настроим нашу программу так, чтобы она запускала 10 000 просмотров на \u003Ccode\u003EConfigMaps\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Emanydirectwatch.go\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Epackage main\n\nimport (\n\t\"context\"\n\t\"fmt\"\n\t\"os\"\n\t\"os\u002Fsignal\"\n\n\t\"go.etcd.io\u002Fetcd\u002Fclient\u002Fpkg\u002Fv3\u002Ftransport\"\n\tclientv3 \"go.etcd.io\u002Fetcd\u002Fclient\u002Fv3\"\n\tv1 \"k8s.io\u002Fapi\u002Fcore\u002Fv1\"\n\t\"k8s.io\u002Fapimachinery\u002Fpkg\u002Fruntime\"\n\t\"k8s.io\u002Fapimachinery\u002Fpkg\u002Fruntime\u002Fserializer\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fetcd3\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fvalue\u002Fencrypt\u002Fidentity\"\n\t\"k8s.io\u002Fkubernetes\u002Fpkg\u002Fapis\u002Fcore\"\n\tk8sv1 \"k8s.io\u002Fkubernetes\u002Fpkg\u002Fapis\u002Fcore\u002Fv1\"\n)\n\nfunc main() {\n\ttlsConfig, err := (transport.TLSInfo{\n\t\tCertFile:       \".\u002Fpki\u002Fetcd\u002Fserver.crt\",\n\t\tKeyFile:        \".\u002Fpki\u002Fetcd\u002Fserver.key\",\n\t\tTrustedCAFile:  \".\u002Fpki\u002Fetcd\u002Fca.crt\",\n\t\tClientCertFile: \".\u002Fpki\u002Fapiserver-etcd-client.crt\",\n\t\tClientKeyFile:  \".\u002Fpki\u002Fapiserver-etcd-client.key\",\n\t}).ClientConfig()\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tc, err := clientv3.New(clientv3.Config{\n\t\tEndpoints: []string{\"https:\u002F\u002F127.0.0.1:2379\"},\n\t\tTLS:       tlsConfig,\n\t})\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\tscheme := runtime.NewScheme()\n\tk8sv1.AddToScheme(scheme)\n\tcore.AddToScheme(scheme)\n\tf := serializer.NewCodecFactory(scheme)\n\ts := etcd3.New(c, f.CodecForVersions(nil, f.UniversalDecoder(), nil, k8sv1.SchemeGroupVersion), nil, \"registry\", v1.Resource(\"ConfigMap\"), identity.NewEncryptCheckTransformer(), true, etcd3.NewDefaultLeaseManagerConfig())\n\tfor i := 0; i &lt; 10000; i++ {\n\t\tw, err := s.Watch(context.Background(), \"configmaps\", storage.ListOptions{\n\t\t\tPredicate: storage.Everything,\n\t\t\tRecursive: true,\n\t\t})\n\t\tif err != nil {\n\t\t\tpanic(err)\n\t\t}\n\t\tgo func() {\n\t\t\tfor e := range w.ResultChan() {\n\t\t\t\tco, ok := e.Object.(*v1.ConfigMap)\n\t\t\t\tif !ok {\n\t\t\t\t\tpanic(\"not a config map!\")\n\t\t\t\t}\n\t\t\t\tfmt.Printf(\"%s || %s\u002F%s\\n\", e.Type, co.Namespace, co.Name)\n\t\t\t}\n\t\t}()\n\t}\n\n\tstop := make(chan os.Signal)\n\tsignal.Notify(stop, os.Interrupt)\n\t&lt;-stop\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЕсли мы запустим программу сейчас, то должны увидеть, что все 10 000 просмотров получают список всех \u003Ccode\u003EConfigMaps\u003C\u002Fcode\u003E в кластере. Когда создадим новую \u003Ccode\u003EConfigMap\u003C\u002Fcode\u003E, мы сможем увидеть, что все часы получают уведомления.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ go run manysimplewatch.go\n...\nADDED || kube-system\u002Fkube-proxy\nADDED || kube-system\u002Fkube-root-ca.crt\nADDED || kube-system\u002Fkubeadm-config\nADDED || kube-system\u002Fkubelet-config\nADDED || local-path-storage\u002Fkube-root-ca.crt\nADDED || local-path-storage\u002Flocal-path-config\nADDED || kube-system\u002Fkube-root-ca.crt\nADDED || kube-system\u002Fkubeadm-config\nADDED || kube-system\u002Fkubelet-config\nADDED || local-path-storage\u002Fkube-root-ca.crt\nADDED || local-path-storage\u002Flocal-path-config\n...\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre\u003E\u003Ccode\u003E$ kubectl create configmap testing\nconfigmap\u002Ftesting created\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre\u003E\u003Ccode\u003E...\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\nADDED || default\u002Ftesting\n...\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОглядываясь назад на наши показатели \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E, мы видим значительный скачок производительности процессора при запуске программы. Это вызывает беспокойство, но, возможно, еще более неприятным является объем работы, который был проделан при создании новой \u003Ccode\u003EConfigMap\u003C\u002Fcode\u003E. Пока нагрузка моделируется в программе, сервер Kubernetes API обслуживает запросы на просмотр от различных клиентов. Устанавливать наблюдение в \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E для каждого из них нет необходимости, ведь серверу API требуется только одно уведомление, чтобы проинформировать всех клиентов.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc9c\u002Fee7\u002F777\u002Fc9cee777704cc14b9c2e085f1788b3d0.png\" width=\"3830\" height=\"2016\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc9c\u002Fee7\u002F777\u002Fc9cee777704cc14b9c2e085f1788b3d0.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EДиапазон значений по оси Y составляет от \u003Ccode\u003E0,00\u003C\u002Fcode\u003E до \u003Ccode\u003E3,00\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003EПервый большой всплеск соответствует моменту запуска нашей программы. Второй всплеск, хотя и меньший, соответствует созданию единой \u003Ccode\u003EConfigMap\u003C\u002Fcode\u003E с установленными 10 000 наблюдениями.\u003C\u002Fp\u003E\u003Ch2\u003EКэширование\u003C\u002Fh2\u003E\u003Cp\u003EКак вы догадались, сервер API Kubernetes использует стратегию кэширования для решения этой проблемы, и взаимодействие со слоем кэширования во многом похоже на прямой вызов \u003Ccode\u003Eetcd3 storage.Interface\u003C\u002Fcode\u003E. Фактически, уровень кэширования реализует \u003Ccode\u003Estorage.Interface\u003C\u002Fcode\u003E тоже.\u003C\u002Fp\u003E\u003Cp\u003EПри построении \u003Ccode\u003Ecacher.Cacher\u003C\u002Fcode\u003E передается структура \u003Ccode\u003EConfig\u003C\u002Fcode\u003E, которая включает в себя \u003Ccode\u003Estorage.Interface\u003C\u002Fcode\u003E. Как указано в \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fkubernetes\u002Fkubernetes\u002Fblob\u002Fe818649c10f29bc80b874889a448da4023918330\u002Fstaging\u002Fsrc\u002Fk8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fcacher\u002Fcacher.go#L241\"\u003E\u003Cu\u003Eстроке документа\u003C\u002Fu\u003E\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\u002F\u002F Cacher implements storage.Interface (although most of the calls are just\n\u002F\u002F delegated to the underlying storage).\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EНапример, поскольку \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E информирует наблюдателя о событиях создания (\u003Ccode\u003EADDED\u003C\u002Fcode\u003E), \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fkubernetes\u002Fkubernetes\u002Fblob\u002Fe818649c10f29bc80b874889a448da4023918330\u002Fstaging\u002Fsrc\u002Fk8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fcacher\u002Fcacher.go#L460\"\u003E\u003Cu\u003Eреализация\u003C\u002Fu\u003E \u003C\u002Fa\u003E\u003Ccode\u003ECreate() Cacher\u003C\u002Fcode\u003E напрямую вызывает \u003Ccode\u003Estorage Create()\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\u002F\u002F Create implements storage.Interface.\nfunc (c *Cacher) Create(ctx context.Context, key string, obj, out runtime.Object, ttl uint64) error {\n\treturn c.storage.Create(ctx, key, obj, out, ttl)\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДругие методы выполняют незначительные операции перед вызовом базового \u003Ccode\u003Estorage\u003C\u002Fcode\u003E, но \u003Ccode\u003EWatch()\u003C\u002Fcode\u003E вообще не взаимодействует с ним напрямую. Вместо этого он создает новый \u003Ccode\u003EcacheWatcher\u003C\u002Fcode\u003E и запускает свой цикл обработки событий. Прежде чем разобраться в том, как работает \u003Ccode\u003EcacheWatcher\u003C\u002Fcode\u003E, нужно понять, как события доставляются из \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E всем наблюдателям, запущенным этим методом. При создании Cacher создаются три важных базовых компонента, два из которых — реализация общих интерфейсов в пакете \u003Ccode\u003Eclient-go cache\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E — реализацией \u003Ccode\u003Ecache.Store\u003C\u002Fcode\u003E;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EcacherListerWatcher\u003C\u002Fcode\u003E — реализацией \u003Ccode\u003Ecache.ListerWatcher\u003C\u002Fcode\u003E;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003EReflector\u003C\u002Fcode\u003E принимает реализации двух ранее упомянутых интерфейсов и использует последний для заполнения первого.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EДавайте рассмотрим каждый из них более подробно.\u003C\u002Fp\u003E\u003Ch2\u003EwatchCache\u003C\u002Fh2\u003E\u003Cp\u003E\u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E  — место, где хранится фактический кэш событий, которые передаются наблюдателям. Это скользящее окно с возможностью изменения размера. Это  означает, что при добавлении нового элемента мы либо удаляем самый старый, либо увеличиваем размер кэша, чтобы вместить добавление нового элемента. Как упоминалось ранее, \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E реализует \u003Ccode\u003Ecache.Store\u003C\u002Fcode\u003E, которое поддерживает следующие методы.  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Etype Store interface {\n\n\t\u002F\u002F Add adds the given object to the accumulator associated with the given object's key\n\tAdd(obj interface{}) error\n\n\t\u002F\u002F Update updates the given object in the accumulator associated with the given object's key\n\tUpdate(obj interface{}) error\n\n\t\u002F\u002F Delete deletes the given object from the accumulator associated with the given object's key\n\tDelete(obj interface{}) error\n\n\t\u002F\u002F List returns a list of all the currently non-empty accumulators\n\tList() []interface{}\n\n\t\u002F\u002F ListKeys returns a list of all the keys currently associated with non-empty accumulators\n\tListKeys() []string\n\n\t\u002F\u002F Get returns the accumulator associated with the given object's key\n\tGet(obj interface{}) (item interface{}, exists bool, err error)\n\n\t\u002F\u002F GetByKey returns the accumulator associated with the given key\n\tGetByKey(key string) (item interface{}, exists bool, err error)\n\n\t\u002F\u002F Replace will delete the contents of the store, using instead the\n\t\u002F\u002F given list. Store takes ownership of the list, you should not reference\n\t\u002F\u002F it after calling this function.\n\tReplace([]interface{}, string) error\n\n\t\u002F\u002F Resync is meaningless in the terms appearing here but has\n\t\u002F\u002F meaning in some implementations that have non-trivial\n\t\u002F\u002F additional behavior (e.g., DeltaFIFO).\n\tResync() error\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EРеализации \u003Ccode\u003EAdd()\u003C\u002Fcode\u003E, \u003Ccode\u003EUpdate()\u003C\u002Fcode\u003E, и \u003Ccode\u003EDelete()\u003C\u002Fcode\u003E создают \u003Ccode\u003Ewatch.Event\u003C\u002Fcode\u003E, затем передайте его методу \u003Ccode\u003EprocessEvent()\u003C\u002Fcode\u003E. Здесь событие преобразуется в \u003Ccode\u003EwatchCacheEvent\u003C\u002Fcode\u003E, который передается \u003Ccode\u003EupdateCache()\u003C\u002Fcode\u003E. Метод \u003Ccode\u003EupdateCache()\u003C\u002Fcode\u003E вместе с вызываемым им методом \u003Ccode\u003EresizeCacheLocked()\u003C\u002Fcode\u003E — это то, где реализована логика скользящего окна.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\u002F\u002F Assumes that lock is already held for write.\nfunc (w *watchCache) updateCache(event *watchCacheEvent) {\n\tw.resizeCacheLocked(event.RecordTime)\n\tif w.isCacheFullLocked() {\n\t\t\u002F\u002F Cache is full - remove the oldest element.\n\t\tw.startIndex++\n\t}\n\tw.cache[w.endIndex%w.capacity] = event\n\tw.endIndex++\n}\n\n\u002F\u002F resizeCacheLocked resizes the cache if necessary:\n\u002F\u002F - increases capacity by 2x if cache is full and all cached events occurred within last eventFreshDuration.\n\u002F\u002F - decreases capacity by 2x when recent quarter of events occurred outside of eventFreshDuration(protect watchCache from flapping).\nfunc (w *watchCache) resizeCacheLocked(eventTime time.Time) {\n\tif w.isCacheFullLocked() &amp;&amp; eventTime.Sub(w.cache[w.startIndex%w.capacity].RecordTime) &lt; eventFreshDuration {\n\t\tcapacity := min(w.capacity*2, w.upperBoundCapacity)\n\t\tif capacity \u003E w.capacity {\n\t\t\tw.doCacheResizeLocked(capacity)\n\t\t}\n\t\treturn\n\t}\n\tif w.isCacheFullLocked() &amp;&amp; eventTime.Sub(w.cache[(w.endIndex-w.capacity\u002F4)%w.capacity].RecordTime) \u003E eventFreshDuration {\n\t\tcapacity := max(w.capacity\u002F2, w.lowerBoundCapacity)\n\t\tif capacity &lt; w.capacity {\n\t\t\tw.doCacheResizeLocked(capacity)\n\t\t}\n\t\treturn\n\t}\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПеред возвратом из \u003Ccode\u003EprocessEvent()\u003C\u002Fcode\u003E вызывается функция \u003Ccode\u003EeventHandler()\u003C\u002Fcode\u003E, если она была передана во время построения \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E. Мы вернемся к этому вскоре, когда рассмотрим, как наблюдатели уведомляются о событиях.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\u002F\u002F Avoid calling event handler under lock.\n\t\u002F\u002F This is safe as long as there is at most one call to Add\u002FUpdate\u002FDelete and\n\t\u002F\u002F UpdateResourceVersion in flight at any point in time, which is true now,\n\t\u002F\u002F because reflector calls them synchronously from its main thread.\n\tif w.eventHandler != nil {\n\t\tw.eventHandler(wcEvent)\n\t}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДругие методы, особенно те, которые включают получение и перечисление, полагаются на базовый \u003Ccode\u003Ecache.Indexer\u003C\u002Fcode\u003E. В итоге \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fkubernetes\u002Fkubernetes\u002Fblob\u002Fe818649c10f29bc80b874889a448da4023918330\u002Fstaging\u002Fsrc\u002Fk8s.io\u002Fclient-go\u002Ftools\u002Fcache\u002Fstore.go#L271\"\u003E\u003Cu\u003Eпростые индексы\u003C\u002Fu\u003E\u003C\u002Fa\u003E, созданные в \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E, сводятся к потокобезопасной \u003Ccode\u003Emap\u003C\u002Fcode\u003E. В то время как скользящее окно событий в \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E помогает отправлять обновления многим различным наблюдателям, индексатор позволяет новым наблюдателям легко получать последнее состояние объектов, что требуется при запуске наблюдения.\u003C\u002Fp\u003E\u003Cp\u003EВместе эти два механизма обслуживают запросы из их хранилища в памяти, вместо того чтобы обращаться к \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E напрямую.\u003C\u002Fp\u003E\u003Ch2\u003EcacherListerWatcher\u003C\u002Fh2\u003E\u003Cp\u003E\u003Ccode\u003EcacherListerWatcher\u003C\u002Fcode\u003E намного проще, чем \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E, так как оборачивает \u003Ccode\u003Estorage.Interface\u003C\u002Fcode\u003E, который передается \u003Ccode\u003ECacher\u003C\u002Fcode\u003E и вызывает базовые методы \u003Ccode\u003EGetList()\u003C\u002Fcode\u003E и \u003Ccode\u003EWatch()\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\u002F\u002F NewCacherListerWatcher returns a storage.Interface backed ListerWatcher.\nfunc NewCacherListerWatcher(storage storage.Interface, resourcePrefix string, newListFunc func() runtime.Object) cache.ListerWatcher {\n\treturn &amp;cacherListerWatcher{\n\t\tstorage:        storage,\n\t\tresourcePrefix: resourcePrefix,\n\t\tnewListFunc:    newListFunc,\n\t}\n}\n\n\u002F\u002F Implements cache.ListerWatcher interface.\nfunc (lw *cacherListerWatcher) List(options metav1.ListOptions) (runtime.Object, error) {\n\tlist := lw.newListFunc()\n\tpred := storage.SelectionPredicate{\n\t\tLabel:    labels.Everything(),\n\t\tField:    fields.Everything(),\n\t\tLimit:    options.Limit,\n\t\tContinue: options.Continue,\n\t}\n\n\tstorageOpts := storage.ListOptions{\n\t\tResourceVersionMatch: options.ResourceVersionMatch,\n\t\tPredicate:            pred,\n\t\tRecursive:            true,\n\t}\n\tif err := lw.storage.GetList(context.TODO(), lw.resourcePrefix, storageOpts, list); err != nil {\n\t\treturn nil, err\n\t}\n\treturn list, nil\n}\n\n\u002F\u002F Implements cache.ListerWatcher interface.\nfunc (lw *cacherListerWatcher) Watch(options metav1.ListOptions) (watch.Interface, error) {\n\topts := storage.ListOptions{\n\t\tResourceVersion: options.ResourceVersion,\n\t\tPredicate:       storage.Everything,\n\t\tRecursive:       true,\n\t\tProgressNotify:  true,\n\t}\n\treturn lw.storage.Watch(context.TODO(), lw.resourcePrefix, opts)\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Ccode\u003EcacherListerWatcher\u003C\u002Fcode\u003E — то, что извлекает данные, которые сохраняются в \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E. Но нужен механизм, чтобы связать их вместе.\u003C\u002Fp\u003E\u003Ch2\u003EReflector\u003C\u002Fh2\u003E\u003Cp\u003E\u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E и \u003Ccode\u003EcacherListerWatcher\u003C\u002Fcode\u003E создают перед \u003Ccode\u003EReflector\u003C\u002Fcode\u003E, чтобы передать их ему. \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003EwatchCache := newWatchCache(\n\t\tconfig.KeyFunc, cacher.processEvent, config.GetAttrsFunc, config.Versioner, config.Indexers, config.Clock, config.GroupResource)\n\tlisterWatcher := NewCacherListerWatcher(config.Storage, config.ResourcePrefix, config.NewListFunc)\n\treflectorName := \"storage\u002Fcacher.go:\" + config.ResourcePrefix\n\n\treflector := cache.NewNamedReflector(reflectorName, listerWatcher, obj, watchCache, 0)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Ccode\u003EReflector\u003C\u002Fcode\u003E определен в пакете \u003Ccode\u003Eclient-go\u002Ftools\u002Fcache\u003C\u002Fcode\u003E со следующей документальной строкой.  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\u002F\u002F Reflector watches a specified resource and causes all changes to be reflected in the given store.\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EБольшая часть функциональности вызывается из его метода \u003Ccode\u003EListAndWatch()\u003C\u002Fcode\u003E Он выполняет то, что следует из его названия: перечисляет, а затем просматривает. События, поступающие от \u003Ccode\u003EListerWatcher (cacherListerWatcher)\u003C\u002Fcode\u003E, обрабатываются в \u003Ccode\u003EwatchHandler()\u003C\u002Fcode\u003E. Именно здесь данные передаются в \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\t\tcase watch.Added:\n\t\t\t\terr := store.Add(event.Object)\n\t\t\t\tif err != nil {\n\t\t\t\t\tutilruntime.HandleError(fmt.Errorf(\"%s: unable to add watch event object (%#v) to store: %v\", name, event.Object, err))\n\t\t\t\t}\n\t\t\tcase watch.Modified:\n\t\t\t\terr := store.Update(event.Object)\n\t\t\t\tif err != nil {\n\t\t\t\t\tutilruntime.HandleError(fmt.Errorf(\"%s: unable to update watch event object (%#v) to store: %v\", name, event.Object, err))\n\t\t\t\t}\n\t\t\tcase watch.Deleted:\n\t\t\t\t\u002F\u002F TODO: Will any consumers need access to the \"last known\n\t\t\t\t\u002F\u002F state\", which is passed in event.Object? If so, may need\n\t\t\t\t\u002F\u002F to change this.\n\t\t\t\terr := store.Delete(event.Object)\n\t\t\t\tif err != nil {\n\t\t\t\t\tutilruntime.HandleError(fmt.Errorf(\"%s: unable to delete watch event object (%#v) from store: %v\", name, event.Object, err))\n\t\t\t\t}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2\u003EСвязываем всё вместе\u003C\u002Fh2\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F966\u002F2c4\u002F00b\u002F9662c400bda4e392faa5d2aaf796fac5.png\" width=\"1920\" height=\"1080\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F966\u002F2c4\u002F00b\u002F9662c400bda4e392faa5d2aaf796fac5.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EКогда все компоненты на месте, пора запустить \u003Ccode\u003EReflector\u003C\u002Fcode\u003E, чтобы извлекать данные из \u003Ccode\u003EcacherListerWatcher\u003C\u002Fcode\u003E и сохранять их в \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E, который будет информировать \u003Ccode\u003ECacher\u003C\u002Fcode\u003E об обновлениях.  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Ego cacher.dispatchEvents()\n\n\tcacher.stopWg.Add(1)\n\tgo func() {\n\t\tdefer cacher.stopWg.Done()\n\t\tdefer cacher.terminateAllWatchers()\n\t\twait.Until(\n\t\t\tfunc() {\n\t\t\t\tif !cacher.isStopped() {\n\t\t\t\t\tcacher.startCaching(stopCh)\n\t\t\t\t}\n\t\t\t}, time.Second, stopCh,\n\t\t)\n\t}()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EСначала рассмотрим второй вызов, \u003Ccode\u003Ecacher.startCaching(stopCh)\u003C\u002Fcode\u003E — так мы запускаем \u003Ccode\u003EReflector\u003C\u002Fcode\u003E с помощью вызова \u003Ccode\u003EListAndWatch()\u003C\u002Fcode\u003E.  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Efunc (c *Cacher) startCaching(stopChannel &lt;-chan struct{}) {\n\t\u002F\u002F The 'usable' lock is always 'RLock'able when it is safe to use the cache.\n\t\u002F\u002F It is safe to use the cache after a successful list until a disconnection.\n\t\u002F\u002F We start with usable (write) locked. The below OnReplace function will\n\t\u002F\u002F unlock it after a successful list. The below defer will then re-lock\n\t\u002F\u002F it when this function exits (always due to disconnection), only if\n\t\u002F\u002F we actually got a successful list. This cycle will repeat as needed.\n\tsuccessfulList := false\n\tc.watchCache.SetOnReplace(func() {\n\t\tsuccessfulList = true\n\t\tc.ready.set(true)\n\t\tklog.V(1).Infof(\"cacher (%v): initialized\", c.groupResource.String())\n\t\tmetrics.WatchCacheInitializations.WithLabelValues(c.groupResource.String()).Inc()\n\t})\n\tdefer func() {\n\t\tif successfulList {\n\t\t\tc.ready.set(false)\n\t\t}\n\t}()\n\n\tc.terminateAllWatchers()\n\t\u002F\u002F Note that since onReplace may be not called due to errors, we explicitly\n\t\u002F\u002F need to retry it on errors under lock.\n\t\u002F\u002F Also note that startCaching is called in a loop, so there's no need\n\t\u002F\u002F to have another loop here.\n\tif err := c.reflector.ListAndWatch(stopChannel); err != nil {\n\t\tklog.Errorf(\"cacher (%v): unexpected ListAndWatch error: %v; reinitializing...\", c.groupResource.String(), err)\n\t}\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЭто приведет к тому, что \u003Ccode\u003EReflector\u003C\u002Fcode\u003E начнет заполнять \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E, который уведомит \u003Ccode\u003ECacher\u003C\u002Fcode\u003E, чтобы он мог отправить его всем наблюдателям. Метод \u003Ccode\u003Ecacher.processEvent()\u003C\u002Fcode\u003E был передан в \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E как \u003Ccode\u003EeventHandler()\u003C\u002Fcode\u003E, который мы видели ранее.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Efunc (c *Cacher) processEvent(event *watchCacheEvent) {\n\tif curLen := int64(len(c.incoming)); c.incomingHWM.Update(curLen) {\n\t\t\u002F\u002F Monitor if this gets backed up, and how much.\n\t\tklog.V(1).Infof(\"cacher (%v): %v objects queued in incoming channel.\", c.groupResource.String(), curLen)\n\t}\n\tc.incoming &lt;- *event\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВсё отправляется по каналу \u003Ccode\u003Ec.incoming\u003C\u002Fcode\u003E, который затем считывается в методе \u003Ccode\u003Ecacher.dispatchEvents()\u003C\u002Fcode\u003E, прежде чем быть отправленным каждому наблюдателю.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\tcase event, ok := &lt;-c.incoming:\n\t\t\tif !ok {\n\t\t\t\treturn\n\t\t\t}\n\t\t\t\u002F\u002F Don't dispatch bookmarks coming from the storage layer.\n\t\t\t\u002F\u002F They can be very frequent (even to the level of subseconds)\n\t\t\t\u002F\u002F to allow efficient watch resumption on kube-apiserver restarts,\n\t\t\t\u002F\u002F and propagating them down may overload the whole system.\n\t\t\t\u002F\u002F\n\t\t\t\u002F\u002F TODO: If at some point we decide the performance and scalability\n\t\t\t\u002F\u002F footprint is acceptable, this is the place to hook them in.\n\t\t\t\u002F\u002F However, we then need to check if this was called as a result\n\t\t\t\u002F\u002F of a bookmark event or regular Add\u002FUpdate\u002FDelete operation by\n\t\t\t\u002F\u002F checking if resourceVersion here has changed.\n\t\t\tif event.Type != watch.Bookmark {\n\t\t\t\tc.dispatchEvent(&amp;event)\n\t\t\t}\n\t\t\tlastProcessedResourceVersion = event.ResourceVersion\n\t\t\tmetrics.EventsCounter.WithLabelValues(c.groupResource.String()).Inc()\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКогда мы вызываем \u003Ccode\u003Ec.dispatchEvent(&amp;event)\u003C\u002Fcode\u003E, список \u003Ccode\u003EcacheWatcher\u003C\u002Fcode\u003E фильтруется по тем, кто заинтересован в данном событии, и событие отправляется каждому.  \u003C\u002Fp\u003E\u003Ch2\u003EМетод Watch()\u003C\u002Fh2\u003E\u003Cp\u003EЭто было непросто, но теперь, когда мы знаем, как обрабатываются события, пришло время вернуться к методу \u003Ccode\u003EWatch()\u003C\u002Fcode\u003E. Вместо запуска нового наблюдения \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E при вызове этого метода, создаем \u003Ccode\u003EcacheWatcher\u003C\u002Fcode\u003E, который добавляется к кандидатам, когда \u003Ccode\u003ECacher\u003C\u002Fcode\u003E обрабатывает события. Каждый \u003Ccode\u003EcacheWatcher\u003C\u002Fcode\u003E имеет свой собственный цикл обработки: \u003Ccode\u003Ewatcher.processInterval()\u003C\u002Fcode\u003E. Метод\u003Ccode\u003E Watch()\u003C\u002Fcode\u003E запускает цикл обработки для наблюдателя, который он создает после добавления его в список наблюдателей для \u003Ccode\u003ECacher\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Efunc() {\n\t\tc.Lock()\n\t\tdefer c.Unlock()\n\t\t\u002F\u002F Update watcher.forget function once we can compute it.\n\t\twatcher.forget = forgetWatcher(c, watcher, c.watcherIdx, triggerValue, triggerSupported)\n\t\tc.watchers.addWatcher(watcher, c.watcherIdx, triggerValue, triggerSupported)\n\n\t\t\u002F\u002F Add it to the queue only when the client support watch bookmarks.\n\t\tif watcher.allowWatchBookmarks {\n\t\t\tc.bookmarkWatchers.addWatcher(watcher)\n\t\t}\n\t\tc.watcherIdx++\n\t}()\n\n\tgo watcher.processInterval(ctx, cacheInterval, watchRV)\n\treturn watcher, nil\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Ccode\u003EcacheInterval\u003C\u002Fcode\u003E создается \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fkubernetes\u002Fkubernetes\u002Fblob\u002Fe818649c10f29bc80b874889a448da4023918330\u002Fstaging\u002Fsrc\u002Fk8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fcacher\u002Fcacher.go#L539\"\u003E\u003Cu\u003Eранее в методе\u003C\u002Fu\u003E \u003C\u002Fa\u003Eи доставляет любые существующие события в \u003Ccode\u003EwatchCache\u003C\u002Fcode\u003E, которые интересуют \u003Ccode\u003EcacheWatcher\u003C\u002Fcode\u003E. Метод \u003Ccode\u003Ewatcher.processInterval()\u003C\u002Fcode\u003E сначала обрабатывает все события из \u003Ccode\u003EcacheInterval\u003C\u002Fcode\u003E, затем начинает ожидать обработки будущих \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fkubernetes\u002Fkubernetes\u002Fblob\u002Fe818649c10f29bc80b874889a448da4023918330\u002Fstaging\u002Fsrc\u002Fk8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fcacher\u002Fcacher.go#L1504\"\u003E\u003Cu\u003Eотправленных событий\u003C\u002Fu\u003E\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E\tfor {\n\t\tevent, err := cacheInterval.Next()\n\t\tif err != nil {\n\t\t\tklog.Warningf(\"couldn't retrieve watch event to serve: %#v\", err)\n\t\t\treturn\n\t\t}\n\t\tif event == nil {\n\t\t\tbreak\n\t\t}\n\t\tc.sendWatchCacheEvent(event)\n\t\t\u002F\u002F With some events already sent, update resourceVersion so that\n\t\t\u002F\u002F events that were buffered and not yet processed won't be delivered\n\t\t\u002F\u002F to this watcher second time causing going back in time.\n\t\tresourceVersion = event.ResourceVersion\n\t\tinitEventCount++\n\t}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cstrong\u003EПримечание\u003C\u002Fstrong\u003E: некоторые комментарии к коду удалены для краткости.\u003C\u002Fp\u003E\u003Cp\u003EОбработка событий состоит из вызова функции \u003Ccode\u003EsendWatchCacheEvent()\u003C\u002Fcode\u003E, которая преобразует его. Затем доставляет по каналу result, который становится тем же каналом, из которого вызывающие функцию \u003Ccode\u003EWatch()\u003C\u002Fcode\u003E могут считывать данные!\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Efunc (c *cacheWatcher) sendWatchCacheEvent(event *watchCacheEvent) {\n\twatchEvent := c.convertToWatchEvent(event)\n\tif watchEvent == nil {\n\t\t\u002F\u002F Watcher is not interested in that object.\n\t\treturn\n\t}\n\n\tselect {\n\tcase &lt;-c.done:\n\t\treturn\n\tdefault:\n\t}\n\n\tselect {\n\tcase c.result &lt;- *watchEvent:\n\tcase &lt;-c.done:\n\t}\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cstrong\u003EПримечание\u003C\u002Fstrong\u003E: некоторые комментарии к коду удалены для краткости.\u003C\u002Fp\u003E\u003Ch2\u003EВсе смотрят… Продуктивно  \u003C\u002Fh2\u003E\u003Cp\u003EДавайте посмотрим на реализацию \u003Ccode\u003ECacher storage.Interface\u003C\u002Fcode\u003E в действии. Мы берём нашу программу и модифицируем её, чтобы передать реализацию хранилища \u003Ccode\u003Eetcd Cacher\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003E\u003Ccode\u003Ecachewatch.go\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Epackage main\n\nimport (\n\t\"context\"\n\t\"fmt\"\n\t\"os\"\n\t\"os\u002Fsignal\"\n\n\t\"go.etcd.io\u002Fetcd\u002Fclient\u002Fpkg\u002Fv3\u002Ftransport\"\n\tclientv3 \"go.etcd.io\u002Fetcd\u002Fclient\u002Fv3\"\n\tv1 \"k8s.io\u002Fapi\u002Fcore\u002Fv1\"\n\t\"k8s.io\u002Fapimachinery\u002Fpkg\u002Ffields\"\n\t\"k8s.io\u002Fapimachinery\u002Fpkg\u002Flabels\"\n\t\"k8s.io\u002Fapimachinery\u002Fpkg\u002Fruntime\"\n\t\"k8s.io\u002Fapimachinery\u002Fpkg\u002Fruntime\u002Fserializer\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fcacher\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fetcd3\"\n\t\"k8s.io\u002Fapiserver\u002Fpkg\u002Fstorage\u002Fvalue\u002Fencrypt\u002Fidentity\"\n\t\"k8s.io\u002Fkubernetes\u002Fpkg\u002Fapis\u002Fcore\"\n\tk8sv1 \"k8s.io\u002Fkubernetes\u002Fpkg\u002Fapis\u002Fcore\u002Fv1\"\n\t\"k8s.io\u002Futils\u002Fclock\"\n)\n\nfunc main() {\n\ttlsConfig, err := (transport.TLSInfo{\n\t\tCertFile:       \".\u002Fpki\u002Fetcd\u002Fserver.crt\",\n\t\tKeyFile:        \".\u002Fpki\u002Fetcd\u002Fserver.key\",\n\t\tTrustedCAFile:  \".\u002Fpki\u002Fetcd\u002Fca.crt\",\n\t\tClientCertFile: \".\u002Fpki\u002Fapiserver-etcd-client.crt\",\n\t\tClientKeyFile:  \".\u002Fpki\u002Fapiserver-etcd-client.key\",\n\t}).ClientConfig()\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tc, err := clientv3.New(clientv3.Config{\n\t\tEndpoints: []string{\"https:\u002F\u002F127.0.0.1:2379\"},\n\t\tTLS:       tlsConfig,\n\t})\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\tscheme := runtime.NewScheme()\n\tk8sv1.AddToScheme(scheme)\n\tcore.AddToScheme(scheme)\n\tf := serializer.NewCodecFactory(scheme)\n\ts := etcd3.New(c, f.CodecForVersions(nil, f.UniversalDecoder(), nil, k8sv1.SchemeGroupVersion), nil, \"registry\", v1.Resource(\"ConfigMap\"), identity.NewEncryptCheckTransformer(), true, etcd3.NewDefaultLeaseManagerConfig())\n\n\tca, err := cacher.NewCacherFromConfig(cacher.Config{\n\t\tStorage:        s,\n\t\tVersioner:      storage.APIObjectVersioner{},\n\t\tGroupResource:  v1.Resource(\"configmaps\"),\n\t\tResourcePrefix: \"configmaps\",\n\t\tKeyFunc:        func(o runtime.Object) (string, error) { return storage.NamespaceKeyFunc(\"configmaps\", o) },\n\t\tGetAttrsFunc: func(o runtime.Object) (label labels.Set, field fields.Set, err error) {\n\t\t\treturn labels.Set{},\n\t\t\t\tfields.Set{}, nil\n\t\t},\n\t\tNewFunc: func() runtime.Object {\n\t\t\treturn &amp;v1.ConfigMap{}\n\t\t},\n\t\tNewListFunc: func() runtime.Object {\n\t\t\treturn &amp;v1.ConfigMapList{}\n\t\t},\n\t\tCodec: f.LegacyCodec(k8sv1.SchemeGroupVersion),\n\t\tClock: clock.RealClock{},\n\t})\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\tfor i := 0; i &lt; 10000; i++ {\n\t\tw, err := ca.Watch(context.Background(), \"configmaps\", storage.ListOptions{\n\t\t\tPredicate: storage.Everything,\n\t\t\tRecursive: true,\n\t\t})\n\t\tif err != nil {\n\t\t\tpanic(err)\n\t\t}\n\t\tgo func() {\n\t\t\tfor e := range w.ResultChan() {\n\t\t\t\tswitch o := e.Object.(type) {\n\t\t\t\tcase *v1.ConfigMap:\n\t\t\t\t\tfmt.Printf(\"%s || %s\u002F%s\\n\", e.Type, o.Namespace, o.Name)\n\t\t\t\tdefault:\n\t\t\t\t\tco, ok := o.(runtime.CacheableObject)\n\t\t\t\t\tif !ok {\n\t\t\t\t\t\tpanic(\"unknown event\")\n\t\t\t\t\t}\n\t\t\t\t\tc, ok := co.GetObject().(*v1.ConfigMap)\n\t\t\t\t\tif !ok {\n\t\t\t\t\t\tpanic(\"unknown object\")\n\t\t\t\t\t}\n\t\t\t\t\tfmt.Printf(\"%s || %s\u002F%s\\n\", e.Type, c.Namespace, c.Name)\n\t\t\t\t}\n\t\t\t}\n\t\t}()\n\t}\n\n\tstop := make(chan os.Signal)\n\tsignal.Notify(stop, os.Interrupt)\n\t&lt;-stop\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПоскольку \u003Ccode\u003EPrometheus\u003C\u002Fcode\u003E все еще запущен и очищает наш экземпляр \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E в нашем кластере \u003Ccode\u003Ekind\u003C\u002Fcode\u003E, мы запускаем нашу программу и видим влияние на процессор.  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ go run cachewatch.go\n...\nADDED || kube-system\u002Fkube-proxy\nADDED || kube-public\u002Fcluster-info\nADDED || kube-system\u002Fcoredns\nADDED || default\u002Fkube-root-ca.crt\nADDED || kube-public\u002Fkube-root-ca.crt\nADDED || kube-system\u002Fkubelet-config\nADDED || kube-system\u002Fkubeadm-config\nADDED || kube-system\u002Fkubeadm-config\nADDED || local-path-storage\u002Fkube-root-ca.crt\nADDED || local-path-storage\u002Flocal-path-config\nADDED || default\u002Fkube-root-ca.crt\n...\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EХотя установлено 10 000 наблюдателей, в нашем экземпляре \u003Ccode\u003Eetcd\u003C\u002Fcode\u003E нет заметного влияния на процессор. То же самое справедливо, если мы создадим новую \u003Ccode\u003EConfigMap\u003C\u002Fcode\u003E.  \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ kubectl create configmap testing\nconfigmap\u002Ftesting created\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre\u003E\u003Ccode\u003E...\nADDED || default\u002Ftesting2\nADDED || default\u002Ftesting2\nADDED || default\u002Ftesting2\nADDED || default\u002Ftesting2\nADDED || default\u002Ftesting2\nADDED || default\u002Ftesting2\nADDED || default\u002Ftesting2\nADDED || default\u002Ftesting2\nADDED || default\u002Ftesting2\n...\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4b4\u002F55f\u002F711\u002F4b455f711901c4aae77963b01c4330b3.png\" width=\"3680\" height=\"1956\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4b4\u002F55f\u002F711\u002F4b455f711901c4aae77963b01c4330b3.png\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EДиапазон оси\u003Cem\u003E \u003C\u002Fem\u003EY \u003Ccode\u003E0.00\u003C\u002Fcode\u003E\u003Cem\u003Eдо \u003C\u002Fem\u003E\u003Ccode\u003E0.18\u003C\u002Fcode\u003E\u003Cem\u003E.\u003C\u002Fem\u003E  \u003C\u002Fp\u003E\u003Ch2\u003EЗаключительные мысли\u003C\u002Fh2\u003E\u003Cp\u003EЭто была вторая часть серии приключений \u003Ca href=\"https:\u002F\u002Fdanielmangum.com\u002Fcategories\u002Fkubernetes-api-server-adventures\u002F\"\u003E\u003Cu\u003Eсервера Kubernetes API\u003C\u002Fu\u003E\u003C\u002Fa\u003E. Основываясь на нашем storage.Interface, мы узнали, как Kubernetes оптимизирует работу watch перед лицом потенциально большого количества клиентов. Как и в большинстве случаев в разработке программного обеспечения, эта оптимизация не лишена компромиссов, но она достигает цели сделать общий случай более эффективным. В \u003Ca href=\"https:\u002F\u002Fslurm.club\u002F3KhyGtd\"\u003E\u003Cu\u003E«Kubernetes: Мега»\u003C\u002Fu\u003E \u003C\u002Fa\u003Eмы рассматриваем и затрагиваем такие области управления инфраструктурой, в которых каждое улучшение может помочь компании сэкономить сотни тысяч рублей.\u003C\u002Fp\u003E\u003Cfigure class=\"full-width \"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw1560\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3a1\u002F637\u002F2e5\u002F3a16372e5f1d1eeb7e513e97e17ef83f.png\" alt=\"https:\u002F\u002Fslurm.club\u002F3KhyGtd\" title=\"https:\u002F\u002Fslurm.club\u002F3KhyGtd\" width=\"780\" height=\"100\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3a1\u002F637\u002F2e5\u002F3a16372e5f1d1eeb7e513e97e17ef83f.png\"\u002F\u003E\u003Cdiv\u003E\u003Cfigcaption\u003E\u003Ca href=\"https:\u002F\u002Fslurm.club\u002F3KhyGtd\"\u003Ehttps:\u002F\u002Fslurm.club\u002F3KhyGtd\u003C\u002Fa\u003E\u003C\u002Ffigcaption\u003E\u003C\u002Fdiv\u003E\u003C\u002Ffigure\u003E\u003Cp\u003EМы посмотрим, есть ли какие-либо случаи, когда этот компромисс вызывает проблемы, в будущих публикациях.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"network"},{"titleHtml":"kubernetes"},{"titleHtml":"k8s"},{"titleHtml":"slurm"},{"titleHtml":"it-компании"},{"titleHtml":"it-инфраструктура"},{"titleHtml":"карьера программиста"},{"titleHtml":"карьера ит-специалиста"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F446\u002F913\u002Fa17\u002F446913a171b09a149098ae918196b04b.png","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F446\u002F913\u002Fa17\u002F446913a171b09a149098ae918196b04b.png","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompanies\\\u002Fsouthbridge\\\u002Farticles\\\u002F727510\\\u002F\"},\"headline\":\"Мир приключений по API-серверу Kubernetes. Часть 2. Наблюдение и кэширование\",\"datePublished\":\"2023-04-07T16:02:21+03:00\",\"dateModified\":\"2023-04-07T17:39:24+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Аня Сокол\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"В нашей предыдущей статье про приключения сервера Kubernetes API мы рассмотрели интерфейс хранилища и исследовали единственную реализацию в дереве: etcd3. Однако...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompanies\\\u002Fsouthbridge\\\u002Farticles\\\u002F727510\\\u002F#post-content-body\",\"about\":[\"c_southbridge\",\"h_it-infrastructure\",\"h_devops\",\"h_kubernetes\",\"f_develop\",\"f_admin\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F727510\\\u002Fb908dcce2dca0bfeea9d535492bee058\\\u002F\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F446\\\u002F913\\\u002Fa17\\\u002F446913a171b09a149098ae918196b04b.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F934\\\u002F15e\\\u002F43f\\\u002F93415e43f565a17db6ed85ce047607db.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F3a1\\\u002Fe4c\\\u002Fb70\\\u002F3a1e4cb705e9372e9e24451daed74cf6.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002Fc9c\\\u002Fee7\\\u002F777\\\u002Fc9cee777704cc14b9c2e085f1788b3d0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F966\\\u002F2c4\\\u002F00b\\\u002F9662c400bda4e392faa5d2aaf796fac5.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F4b4\\\u002F55f\\\u002F711\\\u002F4b455f711901c4aae77963b01c4330b3.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fupload_files\\\u002F3a1\\\u002F637\\\u002F2e5\\\u002F3a16372e5f1d1eeb7e513e97e17ef83f.png\"]}","metaDescription":"В нашей предыдущей статье про приключения сервера Kubernetes API мы рассмотрели интерфейс хранилища и исследовали единственную реализацию в дереве: etcd3. Однако внимательное прочтение сносок в этом...","mainImageUrl":null,"amp":true,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":null,"banner":null,"multiwidget":null,"readingTime":19,"complexity":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[],"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{"727510":{"refs":{},"root":[]}},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{"isCanComment":false,"cantCommentReasonKey":"AUTH_REQUIRED","cantCommentReason":"Authorization required","data":null},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"multiwidgets":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"multiwidgetLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"flows":{"updates":{"countNewPostsBySubscription":null,"countNewPostsAll":54,"countNewNewsAll":49},"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"modal":{"modals":[]},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-356","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffb0\u002Fd35\u002Fcac\u002Ffb0d35cac059015696bbe2d3ec40c769.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main"},"title":"Сезон нейроарта на Хабре","lang":"ru","startTime":"2023-04-07T14:57:00+03:00","finishTime":"2023-04-14T14:57:52+03:00","slides":[{"id":"story-356_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1a7\u002F346\u002Fa55\u002F1a7346a558379effad15fba5e1e40d20.jpg","button":{"title":"Что за конкурс?","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"light"}},{"id":"story-356_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd93\u002Fd9f\u002F0a7\u002Fd93d9f0a793a04ae179c02b50e0dc243.jpg","button":{"title":"Какая обложка?","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"dark"}},{"id":"story-356_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe1a\u002F9b3\u002Ff3e\u002Fe1a9b3f3ed678cd1a591d8ee13fd9728.jpg","button":{"title":"Все правила","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"light"}},{"id":"story-356_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fff6\u002Faae\u002F36a\u002Fff6aae36abd5c4861e6b713306d34277.jpg","button":null},{"id":"story-356_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F159\u002F90f\u002F59e\u002F15990f59e680dce1bbb3bd47cd6f2a36.jpg","button":{"title":"Найти ссылки","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"dark"}},{"id":"story-356_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc08\u002Fe40\u002F31b\u002Fc08e4031b3251ecae64fb53051cbc677.jpg","button":{"title":"К конкурсу","link":"https:\u002F\u002Fu.habr.com\u002Fseas_neuroart_main","colorType":"light"}}]},{"id":"story-354","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F89b\u002Fa37\u002Fecd\u002F89ba37ecd346168d1d2cb61d66dcd516.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s"},"title":"Туториалы по Kubernetes","lang":"ru","startTime":"2023-04-07T14:43:00+03:00","finishTime":"2023-04-16T14:43:00+03:00","slides":[{"id":"story-354_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F036\u002F4e9\u002F9c5\u002F0364e99c56807882ebdccc77bd4bf672.jpg","button":{"title":"Публикации Сезона","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s","colorType":"light"}},{"id":"story-354_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff4d\u002F8fe\u002F8cc\u002Ff4d8fe8cc20d49190abc5325af5d8945.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s","colorType":"dark"}},{"id":"story-354_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F00c\u002F1a7\u002Ff54\u002F00c1a7f548ede2da8500fc8575af45da.jpg","button":{"title":"К постам","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s","colorType":"dark"}},{"id":"story-354_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Feaf\u002Fdf7\u002Fe16\u002Feafdf7e164e761cabbc27f6183b0084d.jpg","button":{"title":"Все посты Сезона","link":"https:\u002F\u002Fu.habr.com\u002Fseas_k8s","colorType":"light"}}]},{"id":"story-352","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fecc\u002F537\u002Fd18\u002Fecc537d1831fd741081b5cef2f7ce8c4.png","title":"Хабр Новости","link":"https:\u002F\u002Fu.habr.com\u002FF7aXs"},"title":"Часы с ChatGPT: время в стихах","lang":"ru","startTime":"2023-04-07T14:39:00+03:00","finishTime":"2023-04-14T14:39:54+03:00","slides":[{"id":"story-352_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F06b\u002F717\u002F79a\u002F06b71779a63ee72a273b2a9bb8a1709c.jpg","button":{"title":"Читать","link":"https:\u002F\u002Fu.habr.com\u002FF7aXs","colorType":"light"}},{"id":"story-352_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6c1\u002Fbda\u002Fb33\u002F6c1bdab3349e82c994aecd3511023fd1.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FF7aXs","colorType":"light"}},{"id":"story-352_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F50d\u002F3dd\u002Fcd6\u002F50d3ddcd6a18fd62391cba35381ee788.jpg","button":{"title":"Вот это новость!","link":"https:\u002F\u002Fu.habr.com\u002FF7aXs","colorType":"light"}}]},{"id":"story-350","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F290\u002F2f5\u002F0d3\u002F2902f50d338f93d8b65285dd2a153463.png","title":"Хабр","link":null},"title":"Читай и худей","lang":"ru","startTime":"2023-04-07T11:01:00+03:00","finishTime":"2023-04-23T23:59:00+03:00","slides":[{"id":"story-350_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F723\u002F65c\u002Fda6\u002F72365cda6d0c14aca18a524fc3e4a0e0.jpg","button":null},{"id":"story-350_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F11e\u002F1c9\u002F727\u002F11e1c9727148e5d0cb8ad95aa9c47b9f.jpg","button":{"title":"Будь готов","link":"https:\u002F\u002Fu.habr.com\u002Fwl-01","colorType":"dark"}},{"id":"story-350_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F979\u002F557\u002F6e4\u002F9795576e46e0ca5941af9b8a523051d5.jpg","button":{"title":"Не ошибись","link":"https:\u002F\u002Fu.habr.com\u002Fwl-02","colorType":"dark"}},{"id":"story-350_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F69a\u002Fd40\u002F433\u002F69ad40433d4262d10a9e70dfc4885ed6.jpg","button":{"title":"Больше о жире","link":"https:\u002F\u002Fu.habr.com\u002Fwl-03","colorType":"dark"}},{"id":"story-350_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fae7\u002Fb48\u002Fa1d\u002Fae7b48a1d46af3cbc4b88f1500d6b548.jpg","button":{"title":"Весь список","link":"https:\u002F\u002Fu.habr.com\u002Fwl-04","colorType":"dark"}},{"id":"story-350_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff1e\u002F2e8\u002Fc45\u002Ff1e2e8c45f91149c9a10660223a8f085.jpg","button":{"title":"Мир внутри нас","link":"https:\u002F\u002Fu.habr.com\u002Fwl-05","colorType":"dark"}},{"id":"story-350_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F37b\u002F031\u002Fa4e\u002F37b031a4e3ff0d236bf7badd391c1eae.jpg","button":{"title":"Что в накладной","link":"https:\u002F\u002Fu.habr.com\u002Fwl-06","colorType":"dark"}}]},{"id":"story-348","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F578\u002F2a2\u002Fc81\u002F5782a2c814e95f41af13315128fcb1b1.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002FciULs"},"title":"Страшен ли Kubernetes?","lang":"ru","startTime":"2023-04-06T11:51:00+03:00","finishTime":"2023-04-16T11:51:00+03:00","slides":[{"id":"story-348_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F232\u002F07d\u002F925\u002F23207d925f0aa40b90c3068b7c7361af.jpg","button":{"title":"Посты Сезона K8s","link":"https:\u002F\u002Fu.habr.com\u002FciULs","colorType":"light"}},{"id":"story-348_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc01\u002F5ac\u002Fe5b\u002Fc015ace5b32ebe07334a4747b52f1648.jpg","button":{"title":"Читать","link":"https:\u002F\u002Fu.habr.com\u002FciULs","colorType":"light"}},{"id":"story-348_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F61c\u002F6a3\u002Fc1c\u002F61c6a3c1c6ed376ea95598b89ffc06a3.jpg","button":{"title":"К сезону K8s","link":"https:\u002F\u002Fu.habr.com\u002FciULs","colorType":"dark"}},{"id":"story-348_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff43\u002F0c2\u002F2e3\u002Ff430c22e3dfdbaa28335e657703eda5b.jpg","button":{"title":"Посты Сезона K8s","link":"https:\u002F\u002Fu.habr.com\u002FciULs","colorType":"dark"}}]},{"id":"story-346","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fef3\u002F1c0\u002Fc10\u002Fef31c0c10a40a5f4a116752bf821862d.png","title":"Хабр Новости","link":"https:\u002F\u002Fu.habr.com\u002FUQDrK"},"title":"На Луну отправят ключ от криптокошелька","lang":"ru","startTime":"2023-04-05T09:00:00+03:00","finishTime":"2023-04-08T08:37:00+03:00","slides":[{"id":"story-346_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb6e\u002F191\u002Fa81\u002Fb6e191a81be6a06b423f2fcf0503a735.jpg","button":null},{"id":"story-346_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4df\u002F13b\u002Fef8\u002F4df13bef890a1a131a9bbabef3fab397.jpg","button":{"title":"Читать","link":"https:\u002F\u002Fu.habr.com\u002FUQDrK","colorType":"light"}},{"id":"story-346_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F092\u002Fe17\u002F779\u002F092e17779d6679632e9577456b7fa605.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FUQDrK","colorType":"light"}}]},{"id":"story-344","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff25\u002Fa1b\u002Fc6b\u002Ff25a1bc6b91f832aa5c40d82fdfef49a.png","title":"Хабр","link":null},"title":"Что почитать: лучшие посты компаний","lang":"ru","startTime":"2023-04-03T12:26:00+03:00","finishTime":"2023-04-10T12:26:09+03:00","slides":[{"id":"story-344_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5f1\u002F9f5\u002F6a4\u002F5f19f56a46e70b325686ab90e2446020.jpg","button":null},{"id":"story-344_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4ca\u002Faea\u002F0dd\u002F4caaea0dd41c829849cbf1d3ef560da1.jpg","button":{"title":"Читать байки","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ftimeweb\u002Fblog\u002F723600\u002F","colorType":"light"}},{"id":"story-344_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F685\u002Fd6a\u002Fafd\u002F685d6aafdc84d5329fff1c517eb9d3c2.jpg","button":{"title":"Сработало?","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fyandex\u002Fblog\u002F721374\u002F","colorType":"light"}},{"id":"story-344_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1fa\u002F736\u002F7f6\u002F1fa7367f62b0791845f12baf2445c98e.jpg","button":{"title":"Что почём","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fwirenboard\u002Fblog\u002F722718\u002F","colorType":"light"}},{"id":"story-344_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdd4\u002F5cf\u002Fd84\u002Fdd45cfd84fd2f71b827f4e0789eb78bc.jpg","button":{"title":"Поразиться","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fods\u002Fblog\u002F722644\u002F","colorType":"light"}},{"id":"story-344_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc0e\u002F06c\u002Ff15\u002Fc0e06cf154b572fe66de237b61c3f2fb.jpg","button":{"title":"Смотреть туториал","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F722266\u002F","colorType":"light"}},{"id":"story-344_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb7f\u002F769\u002F570\u002Fb7f769570bc235a90a7b1840b9044986.jpg","button":{"title":"Узнать больше","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fyandex\u002Fblog\u002F721526\u002F","colorType":"dark"}},{"id":"story-344_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9eb\u002Fddd\u002F38f\u002F9ebddd38feb2c02604380f68f811ad59.jpg","button":{"title":"Миша на севере","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fevateam\u002Fblog\u002F723504\u002F","colorType":"light"}}]},{"id":"story-340","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F69f\u002F045\u002F6b8\u002F69f0456b816950deed68b2f252103517.png","title":"Хабр","link":null},"title":"У вас спина белая","lang":"ru","startTime":"2023-03-31T12:00:00+03:00","finishTime":"2023-04-09T11:35:00+03:00","slides":[{"id":"story-340_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F698\u002F4dc\u002F390\u002F6984dc390750b5dc79c7455585f4c023.jpg","button":null},{"id":"story-340_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F766\u002F491\u002Ff9c\u002F766491f9cf4feb63a279c869797a1c1d.jpg","button":{"title":"Мяу!","link":"https:\u002F\u002Fu.habr.com\u002F1ap_01","colorType":"light"}},{"id":"story-340_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F42e\u002Fba8\u002Fded\u002F42eba8dedff6fe67558e1e275ea45a87.jpg","button":{"title":"Как это?","link":"https:\u002F\u002Fu.habr.com\u002F1ap_02","colorType":"light"}},{"id":"story-340_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F07e\u002F82c\u002Fb9a\u002F07e82cb9aac8be25d4170acde8df1be4.jpg","button":{"title":"История с картинками","link":"https:\u002F\u002Fu.habr.com\u002F1ap_03","colorType":"light"}},{"id":"story-340_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdd2\u002Fcd9\u002Ffc5\u002Fdd2cd9fc55be5940f58cd8ffb6f93512.jpg","button":{"title":"Все истории","link":"https:\u002F\u002Fu.habr.com\u002F1ap_04","colorType":"light"}},{"id":"story-340_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F417\u002Ffcb\u002F031\u002F417fcb03120b16332bab2285a523007e.jpg","button":{"title":"Найти объявление","link":"https:\u002F\u002Fu.habr.com\u002F1ap_05","colorType":"light"}},{"id":"story-340_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F23c\u002Fad8\u002F173\u002F23cad8173e77806710824eb7d6a46540.jpg","button":{"title":"Ревью","link":"https:\u002F\u002Fu.habr.com\u002F1ap_06","colorType":"light"}},{"id":"story-340_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2b7\u002Ff29\u002Fc3b\u002F2b7f29c3b55f335413ee5d7554cbfbda.jpg","button":{"title":"Таков путь","link":"https:\u002F\u002Fu.habr.com\u002F1ap_07","colorType":"light"}},{"id":"story-340_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa86\u002F818\u002F613\u002Fa868186133404a5546241f6b19cebc68.jpg","button":{"title":"Старое доброе","link":"https:\u002F\u002Fu.habr.com\u002F1ap_08","colorType":"light"}}]},{"id":"story-316","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5da\u002Fc64\u002Fd69\u002F5dac64d694253863f7e5990c1fec36a0.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_main"},"title":"Кейсы ML в бизнесе","lang":"ru","startTime":"2023-03-22T13:00:00+03:00","finishTime":"2023-04-09T10:50:00+03:00","slides":[{"id":"story-316_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7d9\u002F36d\u002F3a1\u002F7d936d3a1ea1c6cf17c01ce07eefc775.png","button":null},{"id":"story-316_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F697\u002F2d6\u002F1b4\u002F6972d61b45a6f860460931012f81d7ef.png","button":{"title":"Научиться","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_01","colorType":"dark"}},{"id":"story-316_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd7a\u002Fbc2\u002F191\u002Fd7abc2191c87aa1952f177ac3d72aa5f.png","button":{"title":"Узнать ответ","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_02","colorType":"light"}},{"id":"story-316_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F029\u002F831\u002Ffc2\u002F029831fc28c569b99285992d5fb6afb4.jpg","button":{"title":"Как это?","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_03","colorType":"light"}},{"id":"story-316_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8a2\u002Fb21\u002Ffe2\u002F8a2b21fe2bb6adb9be30d15e3abd1b03.png","button":{"title":"А что ещё?","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_04","colorType":"light"}},{"id":"story-316_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fede\u002F676\u002F079\u002Fede676079c8dbcb467792d71f6f8e2ae.jpg","button":{"title":"И как же?","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_05","colorType":"light"}},{"id":"story-316_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F184\u002F277\u002Fbcb\u002F184277bcb11be803fe1033fd5e182833.png","button":{"title":"Буквы и числа","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_06","colorType":"light"}},{"id":"story-316_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F531\u002F2a0\u002F5b6\u002F5312a05b6bc043afdf86236836bfb028.png","button":{"title":"Разбираемся","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_07","colorType":"light"}},{"id":"story-316_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F32f\u002F8e6\u002Fb63\u002F32f8e6b63ca4642228c671c8328884e3.png","button":{"title":"Читаем","link":"https:\u002F\u002Fu.habr.com\u002FMLseas_08","colorType":"light"}}]},{"id":"story-314","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd4c\u002F911\u002F44c\u002Fd4c91144cb05d33315e57be2bfd5af08.png","title":"Хабр","link":null},"title":"Полезная подборка о зрении","lang":"ru","startTime":"2023-03-21T16:00:00+03:00","finishTime":"2023-04-09T23:59:00+03:00","slides":[{"id":"story-314_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4a1\u002Ff41\u002F14d\u002F4a1f4114d49edde48bec833df98ba458.jpg","button":null},{"id":"story-314_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F68c\u002Fead\u002F0c9\u002F68cead0c9add87d677e3cdd9a9914bec.jpg","button":{"title":"Присмотреться","link":"https:\u002F\u002Fu.habr.com\u002Fzr_01","colorType":"light"}},{"id":"story-314_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7e0\u002F8a0\u002F304\u002F7e08a0304c22f5cdc700436cdecff97d.jpg","button":{"title":"Читать правила","link":"https:\u002F\u002Fu.habr.com\u002Fzr_02","colorType":"light"}},{"id":"story-314_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F189\u002F246\u002Fd5d\u002F189246d5d41e0bad685479a177a5f060.jpg","button":{"title":"Провериться","link":"https:\u002F\u002Fu.habr.com\u002Fzr_03","colorType":"light"}},{"id":"story-314_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F464\u002F80e\u002F77d\u002F46480e77d696dafcd61161e4782bae6a.jpg","button":{"title":"Читать пост","link":"https:\u002F\u002Fu.habr.com\u002Fzr_04","colorType":"dark"}},{"id":"story-314_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F06a\u002F503\u002Fbf5\u002F06a503bf5ec67255007e1687a2573730.jpg","button":{"title":"Узнать больше","link":"https:\u002F\u002Fu.habr.com\u002Fzr_05","colorType":"light"}},{"id":"story-314_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe5e\u002Fa53\u002Fa0b\u002Fe5ea53a0b6f45d43f893fcf8d6d647da.jpg","button":{"title":"Смотреть туториал","link":"https:\u002F\u002Fu.habr.com\u002Fzr_06","colorType":"light"}},{"id":"story-314_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd42\u002Fa6a\u002F5ed\u002Fd42a6a5edb8845acfc321ba577e51c9e.jpg","button":{"title":"Пример настройки","link":"https:\u002F\u002Fu.habr.com\u002Fzr_07","colorType":"light"}}]},{"id":"story-310","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F755\u002F06c\u002Fe7f\u002F75506ce7f8701ea8761ea0ac9d2b72d9.png","title":"Хабр","link":null},"title":"Тренируйся: физкульт-подборка","lang":"ru","startTime":"2023-03-17T11:00:44+03:00","finishTime":"2023-04-09T23:59:00+03:00","slides":[{"id":"story-310_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F649\u002F416\u002F979\u002F64941697969ed302b95b0a11602221d8.jpg","button":null},{"id":"story-310_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F90b\u002F662\u002F984\u002F90b662984b76a7975dc7be8d250cd6b3.jpg","button":{"title":"Вставай на лыжи","link":"https:\u002F\u002Fu.habr.com\u002F8NOwN","colorType":"light"}},{"id":"story-310_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F58a\u002F32e\u002Ff76\u002F58a32ef76f19b55c9169dc5d7c1aa42e.jpg","button":{"title":"Воодушевиться","link":"https:\u002F\u002Fu.habr.com\u002Fv7Zfv","colorType":"light"}},{"id":"story-310_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F134\u002F46d\u002F40c\u002F13446d40c83ee0e5647aca89c8f22b55.jpg","button":{"title":"Смотреть обзор","link":"https:\u002F\u002Fu.habr.com\u002Fn52KP","colorType":"light"}},{"id":"story-310_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F373\u002F0c3\u002Fd52\u002F3730c3d521fc2b7f2b3835ef935f96d3.jpg","button":{"title":"Прогуляться","link":"https:\u002F\u002Fu.habr.com\u002F1Hpbs","colorType":"light"}},{"id":"story-310_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd3c\u002Fb9c\u002Fb42\u002Fd3cb9cb42046eb5b44450aeecd4ef650.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FRZxhy","colorType":"light"}},{"id":"story-310_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbef\u002F940\u002F5ed\u002Fbef9405ed753baca270fef3de37c5735.jpg","button":{"title":"Читать исследование","link":"https:\u002F\u002Fu.habr.com\u002FEMnZT","colorType":"light"}},{"id":"story-310_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb3d\u002Faf4\u002F957\u002Fb3daf495751f36899dc6c7598ef0b42c.jpg","button":{"title":"Поразмыслить","link":"https:\u002F\u002Fu.habr.com\u002FWJzt6","colorType":"light"}}]},{"id":"story-278","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3b2\u002F2b9\u002F874\u002F3b22b9874c30d2e95f06e8ba591d7226.png","title":"Хабр","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F"},"title":"Схватил за мозг","lang":"ru","startTime":"2023-03-06T11:00:00+03:00","finishTime":"2023-04-09T23:59:00+03:00","slides":[{"id":"story-278_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6d2\u002F515\u002F649\u002F6d2515649a98ebff0fff2c95f13aa9e6.jpg","button":null},{"id":"story-278_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6ba\u002F37c\u002F756\u002F6ba37c75671941bb212e0bf815f99550.jpg","button":{"title":"Что оказалось?","link":"https:\u002F\u002Fu.habr.com\u002Fbrain01","colorType":"light"}},{"id":"story-278_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F702\u002Fbe8\u002Fa8f\u002F702be8a8fe21d483936df54dc074b96a.jpg","button":{"title":"Осознать","link":"https:\u002F\u002Fu.habr.com\u002Fbrain02","colorType":"light"}},{"id":"story-278_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9e2\u002F2c2\u002F499\u002F9e22c2499018c37dbb4064053ef7e0a0.jpg","button":{"title":"Отложить таблетку","link":"https:\u002F\u002Fu.habr.com\u002Fbrain03","colorType":"dark"}},{"id":"story-278_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F756\u002F85f\u002F99b\u002F75685f99b00f7a2323028948818a1b66.jpg","button":{"title":"Смотреть советы","link":"https:\u002F\u002Fu.habr.com\u002Fbrain04","colorType":"dark"}},{"id":"story-278_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F442\u002F9a8\u002F159\u002F4429a8159a4280575a30cf1bbbdb3b08.jpg","button":{"title":"Уделить внимание","link":"https:\u002F\u002Fu.habr.com\u002Fbrain05","colorType":"light"}},{"id":"story-278_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F892\u002Fe3e\u002Fa8b\u002F892e3ea8b4ad8934c6858348943804fd.jpg","button":{"title":"Записать нужное","link":"https:\u002F\u002Fu.habr.com\u002Fbrain06","colorType":"light"}},{"id":"story-278_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffa5\u002Ffe9\u002F7bb\u002Ffa5fe97bb1ec4af1e7b1e164171b795c.jpg","button":{"title":"Какое именно?","link":"https:\u002F\u002Fu.habr.com\u002Fbrain07","colorType":"light"}}]},{"id":"story-152","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa49\u002F0d3\u002F609\u002Fa490d3609f29b6dfc53a7b88ab47ca64.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa"},"title":"Сеньоры — очень странные люди","lang":"ru","startTime":"2023-01-23T11:00:00+03:00","finishTime":"2023-04-30T23:59:00+03:00","slides":[{"id":"story-152_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbbb\u002F901\u002F063\u002Fbbb9010630ae483ed1f41ec4e2572c13.png","button":null},{"id":"story-152_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f8\u002F66c\u002F14f\u002F4f866c14f0ca8999334438d7f17c0e3a.png","button":null},{"id":"story-152_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6b9\u002Fa07\u002Fa61\u002F6b9a07a612df213ac3a1c179301828df.png","button":null},{"id":"story-152_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff6b\u002Fadb\u002Fb99\u002Ff6badbb9969d7e34ef4f7492767c6a77.png","button":null},{"id":"story-152_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd9c\u002F9ac\u002F878\u002Fd9c9ac878bec5b494699e0080dd2e813.png","button":null},{"id":"story-152_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdb1\u002Faf9\u002Fc3b\u002Fdb1af9c3bb557f6cee698cf67610f977.png","button":null},{"id":"story-152_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5cf\u002Fbed\u002F65b\u002F5cfbed65bd20b7051b1aac2b9d6e807e.png","button":null},{"id":"story-152_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffa8\u002F251\u002F4a9\u002Ffa82514a9471cd455339e97178d8c021.png","button":null},{"id":"story-152_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbd5\u002F901\u002Fe95\u002Fbd5901e952d9cf638355a3cc8b0c0911.png","button":{"title":"Хочу помочь джуну","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa","colorType":"light"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script> 
  <script src="https://assets.habr.com/habr-web/js/chunk-vendors.04dfe291.js" defer></script>
  <script src="https://assets.habr.com/habr-web/js/page-article-comments.69757054.js" defer></script>
  <script src="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" defer></script>
  <script src="https://assets.habr.com/habr-web/js/app.de623c19.js" defer></script> 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-726094-1"></script> 
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script> 
  <script type="text/javascript">
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script> 
  <noscript> 
   <div> 
    <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt=""> 
   </div> 
  </noscript> 
  <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script> 
  <script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>  
 </body>
</html>